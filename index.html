<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Opening</title>

<style>

    @import url('https://fonts.googleapis.com/css2?family=Bodoni+Moda:opsz,wght@6..96,400..900&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=Kapakana:wght@300..400&display=swap');


    #content-box{
        font-family: "Bodoni Moda", serif !important;
    }

    #guest-name{
        font-family: 'Kapakana', serif;
        font-size: clamp(32px, 5vw, 36px) !important;
    }
    /* Fullscreen clean layout */
    body, html {
        margin: 0;
        padding: 0;
        height: 100%;
        width: 100%;
        overflow: hidden;
        /* font-family: Arial, sans-serif; */
    }

    /* Fullscreen video background */
    .bg-video {
        position: fixed;
        inset: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        z-index: -2;
    }

    /* Dark overlay */
    .overlay {
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.25);
        z-index: -1;
    }

    /* Centered content */
    .content-container {
        position: fixed;
        inset: 0;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        padding: 20px;
        color: white;
    }

    .title {
        font-size: clamp(24px, 4vw, 42px);
        font-weight: 600;
        margin-bottom: 20px;
        line-height: 1.3;
    }

    .guest-name {
        font-size: clamp(20px, 3vw, 32px);
        font-weight: 300;
        margin-bottom: 50px;
    }

    .open-btn {
        padding: 12px 28px;
        background: rgba(255,255,255,0.9);
        color: black;
        border-radius: 999px;
        border: none;
        font-size: clamp(16px, 2vw, 22px);
        font-weight: bold;
        cursor: pointer;
        box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }

    .fade-out {
        opacity: 0;
        transition: opacity 0.6s ease;
        pointer-events: none;
    }
</style>
</head>

<body>

<!-- Background music -->
<audio id="bg-music" loop>
    <source src="music/Queen - The Millionaire Waltz (Official Lyric Video).mp3" type="audio/mp3">
</audio>

<!-- Background video -->
<video autoplay loop muted playsinline class="bg-video">
    <source src="vid/opening.mp4" type="video/mp4">
</video>

<!-- Dark overlay -->
<div class="overlay"></div>

<!-- Content -->
<div id="content-box" class="content-container" >

    <div class="title">
        The Holy Matrimony of <br>
        Christofer & Yovita
    </div>

    <div id="guest-name" class="guest-name">
        Dear Guests
    </div>

    <button id="open-btn" class="open-btn" onclick="openInvitation()">Open Invitation</button>

    <!-- ðŸ”§ Hidden loading text -->
    <div id="loading-text" style="display:none; font-size:24px; margin-top:40px;">
        Loading...
    </div>
</div>

<script>
// to read guest
    const urlParams = new URLSearchParams(window.location.search);
    const guestID = urlParams.get("guest");
    
// to load guest name
    fetch("data/guest.json")
      .then(response => response.json())
      .then(data => {
        const guestNameBox = document.getElementById("guest-name");
    
        if (!guestID || !data[guestID]) {
            guestNameBox.innerHTML = "Dear Guests...";
            return;
        }
    
        const guestName = data[guestID].guest_name;
        guestNameBox.innerHTML = `Dear Guest :<br>${guestName}`;
      });
    
    
// pre-loading images
    const assetsToPreload = [
        "img/background.jpg",
        "img/background2.webp",
        "img/background3test.jpg",
        'img/gallery1.jpg',
        'img/gallery2.jpg',
        'img/gallery3.jpg',
        'music/Queen - The Millionaire Waltz (Official Lyric Video).mp3',
    ];
    
    function preloadAssets(assets) {
        return new Promise((resolve) => {
            let loaded = 0;
    
            assets.forEach(src => {
                const img = new Image();
                img.onload = img.onerror = () => {
                    loaded++;
                    if (loaded === assets.length) resolve();
                };
                img.src = src;
            });
    
            if (assets.length === 0) resolve();
        });
    }
    
    
// open invitation
    function openInvitation() {
        sessionStorage.setItem("playMusic", "yes");

        const audio = document.getElementById("bg-music");
        audio.muted = false;
        audio.volume = 0.5;
        audio.play();

        const openBtn = document.getElementById("open-btn");
        const loadingText = document.getElementById("loading-text");

        // Hide button
        openBtn.style.display = "none";

        // Show loading text (stay visible until fully loaded)
        loadingText.style.display = "block";

        preloadAssets(assetsToPreload).then(() => {
            if (!guestID)
                window.location.href = "main.html";
            else
                window.location.href = "main.html?guest=" + guestID;
        });
    }


    </script>
    

</body>
</html>


